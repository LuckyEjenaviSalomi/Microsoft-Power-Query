// Returns list of month end dates based on a start date and number of months
(start_date as date, n_months as number, optional terminal_date as nullable date)=>

let
    Source = List.Generate(
        ()=>[d = 1, date_ = Date.EndOfMonth(start_date) ],
        each [d] <= n_months,
        each [date_ = Date.EndOfMonth(Date.AddMonths([date_], 1)), d = [d]+1],
        each [date_]
    )

in
    List.Select(Source, each _ >= start_date and _ <= (terminal_date ?? List.Max(Source))  )